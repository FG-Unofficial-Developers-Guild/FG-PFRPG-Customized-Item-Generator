<?xml version="1.0" encoding="iso-8859-1"?>

<root>
	<windowclass name="bmos_createconsumable_window" copy="record_window" />
	<windowclass name="bmos_createconsumable_window_header" copy="record_header" />

	<windowclass name="bmos_createconsumable_window_main">
		<margins control="0,0,0,2" />
		<script>
			function onClose()
				if super and super.onClose then
					super.onClose()
				end
				local nodeSpell = getDatabaseNode()
				local nodeConsumableOptions = DB.getChild(nodeSpell, "bmos_consumables")
				if nodeConsumableOptions then
					DB.deleteNode(nodeConsumableOptions)
				end
			end
		</script>
		<sheetdata>
			<anchor_column name="columnanchor" />

			<label_column name="class_label">
				<static textres="label_bmos_createconsumable_class" />
			</label_column>
			<combobox_column name="class" source="bmos_consumables.class">
				<default textres="blank_bmos_createconsumable" />
				<script file="utility/scripts/combobox_consumable_class.lua" />
			</combobox_column>

			<label_column name="type_label">
				<static textres="label_bmos_createconsumable_type" />
			</label_column>
			<combobox_column name="type" source="bmos_consumables.type">
				<default textres="blank_bmos_createconsumable" />
				<script>
					function onInit()
						if super and super.onInit then
							super.onInit();
						end
					end
					function onValueChanged()
						if super and super.onValueChanged then
							super.onValueChanged();
						end
						window.charges_label.setVisible(getValue() == "Wand");
						window.charges.setVisible(getValue() == "Wand");
					end
				</script>
			</combobox_column>

			<label_column name="casterlevel_label">
				<static textres="label_bmos_createconsumable_cl" />
			</label_column>
			<number_column name="casterlevel" source="bmos_consumables.cl">
				<min>1</min>
				<max>20</max>
			</number_column>

			<label_column name="charges_label">
				<static textres="label_bmos_createconsumable_charges" />
				<invisible />
			</label_column>
			<number_column name="charges">
				<default>50</default>
				<min>0</min>
				<max>50</max>
				<invisible />
			</number_column>

			<button_text_column_center name="button_generate">
				<state textres="button_bmos_createconsumable" />
				<script file="utility/scripts/button_generate_consumable.lua" />
			</button_text_column_center>
        </sheetdata>
	</windowclass>

	<template name="button_text_column_center">
		<button_text>
			<anchored to="columnanchor" width="140">
				<top parent="columnanchor" anchor="bottom" relation="relative" offset="10" />
				<left offset="97" />
			</anchored>
		</button_text>
	</template>
</root>
